/* ====== CONTRIBUTOR PHOTO GALLERY - FRONTEND STYLES ====== */

/* ====== BASE GALLERY GRID ====== */
.cpg-gallery-grid {
    display: grid !important; /* defeat parent flex utilities */
    gap: 1rem;
    padding: 1rem 0;
    justify-items: stretch;
    align-items: start;
    width: 100%;
    max-width: 100%;
    min-width: 0;
    --wp--style--block-gap: initial; /* neutralize block theme gap */
    container-type: inline-size;     /* enable container queries */
  }
  
  /* ensure grid children can shrink in constrained layouts */
  .cpg-gallery-grid > * {
    min-width: 0 !important;
  }
  
  /* ====== BASE CARD STYLES ====== */
  .cpg-photo-card {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 100%;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  
    /* Shadow variables (controlled via PHP inline vars) */
    --cpg-card-shadow-light: 0 2px 8px rgba(0,0,0,0.08);
    --cpg-card-shadow-medium: 0 4px 16px rgba(0,0,0,0.12);
    --cpg-card-shadow-strong: 0 8px 32px rgba(0,0,0,0.16);
    --cpg-card-shadow-hover-light: 0 4px 12px rgba(0,0,0,0.12);
    --cpg-card-shadow-hover-medium: 0 8px 24px rgba(0,0,0,0.16);
    --cpg-card-shadow-hover-strong: 0 16px 48px rgba(0,0,0,0.20);
  }
  
  /* Anchor wrapper inside card */
  .cpg-photo-card a {
    display: flex;
    flex-direction: column;
    height: 100%;
    text-decoration: none;
    color: inherit;
  }
  
  /* ====== DEFAULT/MODERN STYLE ====== */
  .cpg-photo-card.cpg-style-default {
    background: var(--cpg-card-bg, #ffffff);
    border-radius: 12px;
    border: var(--cpg-card-border, 1px solid #e5e5e5);
    box-shadow: var(--cpg-card-shadow, 0 2px 8px rgba(0,0,0,0.08));
  }
  .cpg-photo-card.cpg-style-default:hover {
    transform: translateY(-4px);
    box-shadow: var(--cpg-card-shadow-hover, 0 8px 24px rgba(0,0,0,0.12));
  }
  .cpg-photo-card.cpg-style-default .cpg-photo-image {
    width: 100%;
    aspect-ratio: 4/3;
    overflow: hidden;
    border-radius: 12px 12px 0 0;
  }
  
  /* ====== POLAROID STYLE ====== */
  .cpg-photo-card.cpg-style-polaroid {
    background: var(--cpg-card-bg, #ffffff);
    padding: 16px 16px 20px;
    border-radius: 8px;
    border: var(--cpg-card-border, 1px solid #e5e5e5);
    box-shadow: var(--cpg-card-shadow, 0 4px 16px rgba(0,0,0,0.10));
  }
  .cpg-photo-card.cpg-style-polaroid:hover {
    transform: translateY(-4px) rotate(1deg);
    box-shadow: var(--cpg-card-shadow-hover, 0 8px 24px rgba(0,0,0,0.15));
  }
  .cpg-photo-card.cpg-style-polaroid .cpg-photo-image {
    width: 100%;
    aspect-ratio: 1/1;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 12px;
  }
  .cpg-photo-card.cpg-style-polaroid .cpg-photo-content {
    text-align: center;
    padding: 0;
  }
  .cpg-photo-card.cpg-style-polaroid .cpg-photo-content p {
    font-family: "Georgia", "Times New Roman", "Playfair Display", serif;
    font-size: 12px;
    font-weight: 400;
    color: var(--cpg-caption-color, #2c3338);
    margin: 0;
    line-height: 1.3;
    text-align: center;
    letter-spacing: 0.3px;
    font-style: italic;
    text-shadow: 0 0.5px 1px rgba(0,0,0,0.1);
  }
  
  /* ====== CIRCLE STYLE ====== */
  .cpg-photo-card.cpg-style-circle {
    background: transparent;
    border: none;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px 16px;
    box-shadow: none;
    min-height: auto;
    position: relative;
    width: 100%;
    max-width: 100%;
  }
  .cpg-photo-card.cpg-style-circle .cpg-photo-image {
    width: 200px;
    height: 200px;
    position: relative;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    margin: 0 auto 16px;
    display: block;
    background: #f8f9fa;
    box-shadow: var(--cpg-card-shadow, 0 8px 32px rgba(0,0,0,0.16));
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .cpg-photo-card.cpg-style-circle:hover .cpg-photo-image {
    transform: translateY(-6px) scale(1.04);
    box-shadow: var(--cpg-card-shadow-hover, 0 20px 60px rgba(0,0,0,0.25));
  }
  .cpg-photo-card.cpg-style-circle .cpg-photo-image::before {
    content: "";
    position: absolute;
    top: -3px;
    left: -3px;
    width: calc(100% + 6px);
    height: calc(100% + 6px);
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.9);
    z-index: 1;
    box-sizing: border-box;
    transition: border-color 0.3s ease;
  }
  .cpg-photo-card.cpg-style-circle:hover .cpg-photo-image::before {
    border-color: rgba(255,255,255,1);
  }
  .cpg-photo-card.cpg-style-circle .cpg-photo-image img {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover; object-position: center center;
    border-radius: 50%;
    display: block;
    z-index: 2;
  }
  .cpg-photo-card.cpg-style-circle .cpg-photo-content {
    padding: 10px 0 0;
    background: transparent;
    text-align: center;
    width: 100%;
  }
  .cpg-photo-card.cpg-style-circle .cpg-photo-content p {
    font-size: 14px;
    font-weight: 500;
    color: var(--cpg-caption-color, #2c3338);
    line-height: 1.3;
  }
  
  /* ====== FIXED HEIGHT STYLE ====== */
  .cpg-photo-card.cpg-style-fixed {
    background: var(--cpg-card-bg, #ffffff);
    border-radius: 12px;
    border: var(--cpg-card-border, 1px solid #e5e5e5);
    box-shadow: var(--cpg-card-shadow, 0 2px 8px rgba(0,0,0,0.08));
    height: 320px;
  }
  .cpg-photo-card.cpg-style-fixed:hover {
    transform: translateY(-4px);
    box-shadow: var(--cpg-card-shadow-hover, 0 8px 24px rgba(0,0,0,0.12));
  }
  .cpg-photo-card.cpg-style-fixed .cpg-photo-image {
    width: 100%;
    height: 240px;
    overflow: hidden;
    border-radius: 12px 12px 0 0;
    flex-shrink: 0;
  }
  .cpg-photo-card.cpg-style-fixed .cpg-photo-content {
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
  }
  .cpg-photo-card.cpg-style-fixed .cpg-photo-content p {
    font-size: 13px;
    font-weight: 500;
    line-height: 1.4;
  }
  
  /* ====== COMMON IMAGE STYLES ====== */
  .cpg-photo-image {
    position: relative;
    background: #f8f9fa;
  }
  .cpg-photo-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
    transition: opacity 0.3s ease;
  }
  
  /* ====== CONTENT/CAPTION STYLES ====== */
  .cpg-photo-content {
    padding: 1rem;
    flex-grow: 1;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .cpg-photo-content p {
    margin: 0;
    font-size: 14px;
    font-weight: 500;
    line-height: 1.4;
    color: var(--cpg-caption-color, #374151);
    text-align: center;
    word-wrap: break-word;
    hyphens: auto;
  }
  
  /* Hide captions when disabled */
  .cpg-gallery-grid.cpg-no-captions .cpg-photo-content { display: none !important; }
  .cpg-gallery-grid.cpg-no-captions .cpg-photo-card.cpg-style-fixed { height: 240px; }
  .cpg-gallery-grid.cpg-no-captions .cpg-photo-card.cpg-style-fixed .cpg-photo-image { border-radius: 12px; }
  .cpg-gallery-grid.cpg-no-captions .cpg-photo-card.cpg-style-circle { min-height: 0; }
  .cpg-gallery-grid.cpg-no-captions .cpg-photo-card.cpg-style-circle .cpg-photo-image { margin-bottom: 0; }
  
  /* ====== ERROR STATE ====== */
  .cpg-photos-error {
    padding: 2rem;
    background: #fef3f2;
    border: 1px solid #fecaca;
    border-radius: 12px;
    color: #dc2626;
    text-align: center;
    font-weight: 500;
  }
  
  /* ====== DESKTOP-FIRST COLUMN CLASSES (HIGH SPECIFICITY) ====== */
  .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
  .cpg-gallery-grid.cpg-gallery-grid.columns-2 { grid-template-columns: repeat(2, 1fr) !important; }
  .cpg-gallery-grid.cpg-gallery-grid.columns-3 { grid-template-columns: repeat(3, 1fr) !important; }
  .cpg-gallery-grid.cpg-gallery-grid.columns-4 { grid-template-columns: repeat(4, 1fr) !important; }
  .cpg-gallery-grid.cpg-gallery-grid.columns-5 { grid-template-columns: repeat(5, 1fr) !important; }
  .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(6, 1fr) !important; }
  
  /* ====== RESPONSIVE OVERRIDES ====== */
  /* Mobile Portrait (320-479) — force 1 column */
  @media screen and (max-width: 479px) {
    .cpg-gallery-grid { gap: 1rem; padding: 0.75rem 0; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1,
    .cpg-gallery-grid.cpg-gallery-grid.columns-2,
    .cpg-gallery-grid.cpg-gallery-grid.columns-3,
    .cpg-gallery-grid.cpg-gallery-grid.columns-4,
    .cpg-gallery-grid.cpg-gallery-grid.columns-5,
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(1, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 220px; height: 220px; }
    .cpg-photo-card.cpg-style-fixed { height: 300px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 220px; }
    .cpg-photo-content { padding: 0.75rem; }
    .cpg-photo-content p { font-size: 14px; }
    .cpg-photo-card.cpg-style-circle .cpg-photo-content p { font-size: 13px; }
    .cpg-photo-card.cpg-style-polaroid .cpg-photo-content p { font-size: 11px; }
  }
  
  /* Mobile Landscape (480-639) — max 2 columns */
  @media screen and (min-width: 480px) and (max-width: 639px) {
    .cpg-gallery-grid { gap: 1.25rem; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-2,
    .cpg-gallery-grid.cpg-gallery-grid.columns-3,
    .cpg-gallery-grid.cpg-gallery-grid.columns-4,
    .cpg-gallery-grid.cpg-gallery-grid.columns-5,
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(2, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 160px; height: 160px; }
    .cpg-photo-card.cpg-style-fixed { height: 280px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 200px; }
    .cpg-photo-content p { font-size: 13px; }
    .cpg-photo-card.cpg-style-circle .cpg-photo-content p { font-size: 12px; }
    .cpg-photo-card.cpg-style-polaroid .cpg-photo-content p { font-size: 10px; }
  }
  
  /* Tablet Portrait (640-767) — max 3 columns */
  @media screen and (min-width: 640px) and (max-width: 767px) {
    .cpg-gallery-grid { gap: 1.5rem; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-2 { grid-template-columns: repeat(2, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-3,
    .cpg-gallery-grid.cpg-gallery-grid.columns-4,
    .cpg-gallery-grid.cpg-gallery-grid.columns-5,
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(3, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 140px; height: 140px; }
    .cpg-photo-card.cpg-style-fixed { height: 300px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 220px; }
  }
  
  /* Tablet Landscape (768-1023) — max 4 columns */
  @media screen and (min-width: 768px) and (max-width: 1023px) {
    .cpg-gallery-grid { gap: 1.5rem; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-2 { grid-template-columns: repeat(2, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-3 { grid-template-columns: repeat(3, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-4,
    .cpg-gallery-grid.cpg-gallery-grid.columns-5,
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(4, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 150px; height: 150px; }
    .cpg-photo-card.cpg-style-fixed { height: 300px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 220px; }
  }
  
  /* Small Desktop (1024-1199) — max 5 columns */
  @media screen and (min-width: 1024px) and (max-width: 1199px) {
    .cpg-gallery-grid { gap: 1.75rem; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-2 { grid-template-columns: repeat(2, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-3 { grid-template-columns: repeat(3, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-4 { grid-template-columns: repeat(4, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-5,
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(5, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 160px; height: 160px; }
    .cpg-photo-card.cpg-style-fixed { height: 320px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 240px; }
  }
  
  /* Large Desktop (1200+) — all 6 columns */
  @media screen and (min-width: 1200px) {
    .cpg-gallery-grid { gap: 2rem; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-1 { grid-template-columns: repeat(1, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-2 { grid-template-columns: repeat(2, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-3 { grid-template-columns: repeat(3, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-4 { grid-template-columns: repeat(4, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-5 { grid-template-columns: repeat(5, 1fr) !important; }
    .cpg-gallery-grid.cpg-gallery-grid.columns-6 { grid-template-columns: repeat(6, 1fr) !important; }
  
    .cpg-photo-card.cpg-style-circle .cpg-photo-image { width: 180px; height: 180px; }
    .cpg-photo-card.cpg-style-fixed { height: 340px; }
    .cpg-photo-card.cpg-style-fixed .cpg-photo-image { height: 260px; }
  }
  
  /* ====== LOADING STATES ====== */
  .cpg-photo-image img[style*="opacity: 0"] {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
  }
  @keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
  
  /* ====== HIGH DPI DISPLAYS ====== */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .cpg-photo-card { image-rendering: -webkit-optimize-contrast; }
  }
  
  /* ====== SHADOW UNIFICATION SAFEGUARDS ====== */
  .cpg-photo-card,
  .cpg-photo-card:hover,
  .cpg-photo-card .cpg-photo-image,
  .cpg-photo-card:hover .cpg-photo-image {
    box-shadow: var(--cpg-card-shadow, initial);
  }
  .cpg-photo-card:hover,
  .cpg-photo-card.cpg-style-polaroid:hover,
  .cpg-photo-card.cpg-style-default:hover,
  .cpg-photo-card.cpg-style-fixed:hover,
  .cpg-photo-card.cpg-style-circle:hover .cpg-photo-image {
    box-shadow: var(--cpg-card-shadow-hover, var(--cpg-card-shadow, initial));
  }
  
  /* Belt-and-suspenders: if parent uses flex utilities */
  .is-layout-flex .cpg-gallery-grid,
  .wp-block-group .cpg-gallery-grid { display: grid !important; }  